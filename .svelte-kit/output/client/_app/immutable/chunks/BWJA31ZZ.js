import{d as Ke,p as We,a as M,B as Xe,s as R,b as Ye,M as Ze,u as $e,f as p,j as ue,k as g,G as et,t as b,m as tt,n as u,o as at,h as n,i as l,x as N,q as h,r,g as s,c as pe,C as st,e as y,D as _e}from"./d1NyGob4.js";import{m as ot,c as rt,h as it,p as nt,j as me,b as ct,E as P,a as lt,l as dt,d as vt,e as ut,o as pt}from"./kvhWSe6K.js";import{o as V,q as fe}from"./DsZ6whlC.js";const ge=[{id:"javascript",name:"JavaScript",extension:"js",executable:!0,mimeType:"text/javascript",codemirrorMode:"javascript"},{id:"typescript",name:"TypeScript",extension:"ts",executable:!1,mimeType:"text/typescript",codemirrorMode:"javascript"},{id:"python",name:"Python",extension:"py",executable:!0,mimeType:"text/x-python",codemirrorMode:"python"},{id:"html",name:"HTML",extension:"html",executable:!0,mimeType:"text/html",codemirrorMode:"html"},{id:"css",name:"CSS",extension:"css",executable:!1,mimeType:"text/css",codemirrorMode:"css"},{id:"json",name:"JSON",extension:"json",executable:!1,mimeType:"application/json",codemirrorMode:"json"},{id:"markdown",name:"Markdown",extension:"md",executable:!1,mimeType:"text/markdown",codemirrorMode:"markdown"},{id:"sql",name:"SQL",extension:"sql",executable:!1,mimeType:"text/x-sql",codemirrorMode:"sql"},{id:"bash",name:"Bash",extension:"sh",executable:!1,mimeType:"text/x-sh",codemirrorMode:"shell"}];async function _t(C,c,a,S,B,A){if(!fe.isLanguageExecutable(c().language)){y(a,{success:!1,error:`Execution not supported for ${c().language}`,executionTime:0,timestamp:new Date},!0);return}y(S,!0),y(a,null);try{const k=await fe.executeCode(c().code,c().language);y(a,k,!0),B({output:k.output,error:k.error,lastExecuted:k.timestamp}),A("execute",k)}catch(k){y(a,{success:!1,error:k instanceof Error?k.message:"Unknown execution error",executionTime:0,timestamp:new Date},!0)}finally{y(S,!1)}}var mt=p("<option> </option>"),ft=p('<span class="code-title svelte-1k3gzz5"> </span>'),gt=(C,c)=>c(),ht=p('<button class="action-btn svelte-1k3gzz5" title="Format code">üé®</button> <button class="action-btn svelte-1k3gzz5" title="Save version">üíæ</button>',1),xt=(C,c)=>y(c,!s(c)),zt=p('<button title="Version history">üìö</button>'),kt=p('<button class="action-btn execute-btn svelte-1k3gzz5" title="Execute code"><!></button>'),bt=p('<div><div class="output-header svelte-1k3gzz5"><span class="output-label svelte-1k3gzz5"> </span> <span class="execution-time svelte-1k3gzz5"> </span></div> <pre class="output-content svelte-1k3gzz5"> </pre></div>'),yt=(C,c)=>y(c,!1),St=p('<span class="diff-added svelte-1k3gzz5"> </span>'),jt=p('<span class="diff-removed svelte-1k3gzz5"> </span>'),wt=p('<span class="diff-modified svelte-1k3gzz5"> </span>'),Et=p('<div class="diff-stats svelte-1k3gzz5"><!> <!> <!></div>'),Mt=(C,c,a)=>c(s(a).id),Ct=p('<button class="restore-btn svelte-1k3gzz5" title="Restore this version">‚Ü∂</button>'),Tt=p('<div><div class="version-info svelte-1k3gzz5"><div class="version-meta svelte-1k3gzz5"><span class="version-description svelte-1k3gzz5"> </span> <span class="version-author svelte-1k3gzz5"> </span></div> <div class="version-timestamp svelte-1k3gzz5"> </div> <!></div> <!></div>'),Vt=p('<div class="version-panel svelte-1k3gzz5"><div class="version-header svelte-1k3gzz5"><h4 class="svelte-1k3gzz5">Version History</h4> <div class="version-actions svelte-1k3gzz5"><button class="action-btn svelte-1k3gzz5" title="Export history">üì§</button> <button class="action-btn svelte-1k3gzz5">‚úñÔ∏è</button></div></div> <div class="version-list svelte-1k3gzz5"></div></div>'),Lt=p('<div><div class="editor-header svelte-1k3gzz5"><div class="editor-info svelte-1k3gzz5"><select class="language-select svelte-1k3gzz5"></select> <!> <span class="version-info svelte-1k3gzz5"> </span></div> <div class="editor-actions svelte-1k3gzz5"><!> <!> <!></div></div> <div class="editor-container svelte-1k3gzz5"><div class="editor-mount svelte-1k3gzz5"></div></div> <!> <!></div>');function qt(C,c){We(c,!0);let a=M(c,"content",15),S=M(c,"readonly",3,!1),B=M(c,"theme",3,"light");M(c,"showLineNumbers",3,!0);let A=M(c,"showExecuteButton",3,!0),k=M(c,"showVersionHistory",3,!0),he=M(c,"height",3,"300px");const L=Xe();let J,_=null,I=R(!1),w=R(null),O=R(!1),Q=R(Ye(V.getVersionHistory(a())));const xe={javascript:me(),typescript:me({typescript:!0}),python:nt(),html:it(),css:rt(),json:lt(),markdown:ot()};Ze(()=>(te(),()=>{_&&_.destroy()})),$e(()=>{_&&a().language&&te()});function te(){_&&_.destroy();const e=[ct,P.theme({"&":{height:he()},".cm-scroller":{fontFamily:'Monaco, Menlo, "Ubuntu Mono", monospace'},".cm-focused":{outline:"none"}}),P.updateListener.of(i=>{if(i.docChanged&&!S()){const d=i.state.doc.toString();K({code:d})}})],t=xe[a().language];t&&e.push(t),B()==="dark"&&e.push(pt),(a().language==="javascript"||a().language==="typescript")&&e.push(dt(ze),vt());const o=ut.create({doc:a().code||"",extensions:e});_=new P({state:o,parent:J}),S()&&_.dispatch({effects:P.editable.of(!1)})}function ze(e){const t=[],o=e.state.doc.toString();try{new Function(o)}catch(i){if(i instanceof SyntaxError){const d=i.message.match(/line (\d+)/),m=d?parseInt(d[1])-1:0,f=e.state.doc.line(Math.min(m+1,e.state.doc.lines)).from;t.push({from:f,to:f+1,severity:"error",message:i.message})}}return t}function K(e){a({...a(),...e}),L("contentchange",a())}function ke(e){const t=V.createVersion(a(),a().code,e,"User");a(t),y(Q,V.getVersionHistory(a()),!0),L("versionCreated",t),L("contentchange",t)}function be(e){const t=V.restoreToVersion(a(),e);t&&(a(t),y(Q,V.getVersionHistory(a()),!0),_&&_.dispatch({changes:{from:0,to:_.state.doc.length,insert:a().code}}),L("contentchange",a()))}function ye(){const e=V.exportVersionHistory(a()),t=new Blob([e],{type:"application/json"}),o=URL.createObjectURL(t),i=document.createElement("a");i.href=o,i.download=`code-history-${a().title||"untitled"}.json`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(o)}function Se(){let e=a().code;(a().language==="javascript"||a().language==="typescript")&&(e=e.replace(/;/g,`;
`).replace(/{/g,`{
`).replace(/}/g,`
}`).replace(/\n\s*\n/g,`
`)),_&&_.dispatch({changes:{from:0,to:_.state.doc.length,insert:e}}),K({code:e})}let je=pe(()=>ge.find(e=>e.id===a().language)),we=pe(()=>s(je)?.executable&&A());var F=Lt();let ae;var W=n(F),X=n(W),H=n(X);ue(H,21,()=>ge,e=>e.id,(e,t)=>{var o=mt(),i=n(o,!0);r(o);var d={};b(()=>{h(i,s(t).name),d!==(d=s(t).id)&&(o.value=(o.__value=s(t).id)??"")}),u(e,o)}),r(H);var se=l(H,2);{var Ee=e=>{var t=ft(),o=n(t,!0);r(t),b(()=>h(o,a().title)),u(e,t)};g(se,e=>{a().title&&e(Ee)})}var oe=l(se,2),Me=n(oe);r(oe),r(X);var re=l(X,2),ie=n(re);{var Ce=e=>{var t=ht(),o=st(t);o.__click=Se;var i=l(o,2);i.__click=[gt,ke],u(e,t)};g(ie,e=>{S()||e(Ce)})}var ne=l(ie,2);{var Te=e=>{var t=zt();t.__click=[xt,O];let o;b(i=>o=N(t,1,"action-btn svelte-1k3gzz5",null,o,i),[()=>({active:s(O)})]),u(e,t)};g(ne,e=>{k()&&e(Te)})}var Ve=l(ne,2);{var Le=e=>{var t=kt();t.__click=[_t,a,w,I,K,L];var o=n(t);{var i=m=>{var f=_e("‚è≥");u(m,f)},d=m=>{var f=_e("‚ñ∂Ô∏è");u(m,f)};g(o,m=>{s(I)?m(i):m(d,!1)})}r(t),b(()=>t.disabled=s(I)||S()),u(e,t)};g(Ve,e=>{s(we)&&e(Le)})}r(re),r(W);var Y=l(W,2),He=n(Y);et(He,e=>J=e,()=>J),r(Y);var ce=l(Y,2);{var Ue=e=>{var t=bt();let o;var i=n(t),d=n(i),m=n(d,!0);r(d);var f=l(d,2),U=n(f);r(f),r(i);var v=l(i,2),T=n(v,!0);r(v),r(t),b((G,D)=>{o=N(t,1,"execution-output svelte-1k3gzz5",null,o,G),h(m,s(w).success?"‚úÖ Output":"‚ùå Error"),h(U,`${D??""}ms`),h(T,s(w).success?s(w).output:s(w).error)},[()=>({error:!s(w).success}),()=>s(w).executionTime.toFixed(2)]),u(e,t)};g(ce,e=>{s(w)&&e(Ue)})}var De=l(ce,2);{var qe=e=>{var t=Vt(),o=n(t),i=l(n(o),2),d=n(i);d.__click=ye;var m=l(d,2);m.__click=[yt,O],r(i),r(o);var f=l(o,2);ue(f,21,()=>s(Q),U=>U.id,(U,v)=>{var T=Tt();let G;var D=n(T),Z=n(D),$=n(Z),Be=n($,!0);r($);var le=l($,2),Oe=n(le,!0);r(le),r(Z);var ee=l(Z,2),Fe=n(ee,!0);r(ee);var Ge=l(ee,2);{var Re=j=>{var E=Et(),de=n(E);{var Ae=x=>{var z=St(),q=n(z);r(z),b(()=>h(q,`+${s(v).diffStats.added??""}`)),u(x,z)};g(de,x=>{s(v).diffStats.added>0&&x(Ae)})}var ve=l(de,2);{var Je=x=>{var z=jt(),q=n(z);r(z),b(()=>h(q,`-${s(v).diffStats.removed??""}`)),u(x,z)};g(ve,x=>{s(v).diffStats.removed>0&&x(Je)})}var Ie=l(ve,2);{var Qe=x=>{var z=wt(),q=n(z);r(z),b(()=>h(q,`~${s(v).diffStats.modified??""}`)),u(x,z)};g(Ie,x=>{s(v).diffStats.modified>0&&x(Qe)})}r(E),u(j,E)};g(Ge,j=>{s(v).diffStats&&j(Re)})}r(D);var Ne=l(D,2);{var Pe=j=>{var E=Ct();E.__click=[Mt,be,v],u(j,E)};g(Ne,j=>{s(v).id!=="current"&&!S()&&j(Pe)})}r(T),b((j,E)=>{G=N(T,1,"version-item svelte-1k3gzz5",null,G,j),h(Be,s(v).description),h(Oe,s(v).author),h(Fe,E)},[()=>({current:s(v).id==="current"}),()=>s(v).timestamp.toLocaleString()]),u(U,T)}),r(f),r(t),u(e,t)};g(De,e=>{s(O)&&e(qe)})}r(F),b(e=>{ae=N(F,1,"code-editor svelte-1k3gzz5",null,ae,e),H.disabled=S(),h(Me,`v${a().version??""}`)},[()=>({dark:B()==="dark"})]),tt(H,()=>a().language,e=>a(a().language=e,!0)),u(C,F),at()}Ke(["click"]);export{qt as C};
