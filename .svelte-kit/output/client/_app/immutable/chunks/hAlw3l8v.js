import{b as d,g as c,e as u}from"./D9dWO0Sc.js";import{d as f}from"./DvEoYHKW.js";const a=f("web-content-state"),e=d({sources:{items:{},currentSource:null,isLoading:!1,lastUpdated:null},content:{items:{},currentContent:null,isProcessing:!1,processingProgress:0},batch:{jobs:{},activeJob:null,queue:[],isProcessing:!1},transformation:{opportunities:[],isAnalyzing:!1,currentTransformation:null,transformationHistory:[]},ui:{activeView:"sources",selectedItems:[],searchQuery:"",filters:{domain:"",category:"",status:"all"},notifications:[]}}),m=u(()=>()=>{const{items:t}=e.sources,{searchQuery:s,filters:o}=e.ui;let n=Object.values(t);const r=(s||"").toLowerCase();return r.trim()&&(n=n.filter(i=>i.title.toLowerCase().includes(r)||i.domain.toLowerCase().includes(r)||i.metadata.tags.some(l=>l.toLowerCase().includes(r)))),o.domain&&(n=n.filter(i=>i.domain===o.domain)),o.category&&(n=n.filter(i=>i.metadata.category===o.category)),o.status!=="all"&&(n=n.filter(i=>i.status===o.status)),n});function S(){return c(m)()}const g=u(()=>()=>{const t=Object.keys(e.sources.items).length,s=Object.keys(e.content.items).length,o=Object.values(e.batch.jobs).filter(n=>n.status==="processing").length;return{totalSources:t,totalContent:s,activeJobs:o,transformationOpportunities:e.transformation.opportunities.length}});function C(){return c(g)()}const p=u(()=>()=>{const t=e.batch.activeJob;if(!t)return null;const s=t.results.filter(r=>r.success===!0).length,o=t.results.filter(r=>r.success===!1).length,n=t.urls.length;return{completed:s,failed:o,total:n,percentage:n>0?Math.round((s+o)/n*100):0}});function w(){return c(p)()}const h={addSource:t=>{e.sources.items[t.id]=t,e.sources.lastUpdated=Date.now().toString(),a.info(`Added source: ${t.title}`)},updateSource:(t,s)=>{const o=e.sources.items[t];if(o){const n={...o,...s,lastChecked:new Date};e.sources.items[t]=n,e.sources.lastUpdated=Date.now().toString(),a.info(`Updated source: ${t}`)}},removeSource:t=>{e.sources.items[t]&&(delete e.sources.items[t],e.sources.lastUpdated=Date.now().toString(),a.info(`Removed source: ${t}`))},setCurrentSource:t=>{e.sources.currentSource=t},setSourcesLoading:t=>{e.sources.isLoading=t},addContent:t=>{e.content.items[t.id]=t,a.info(`Added content: ${t.title}`)},updateContent:(t,s)=>{const o=e.content.items[t];o&&(e.content.items[t]={...o,...s},a.info(`Updated content: ${t}`))},setCurrentContent:t=>{e.content.currentContent=t},setContentProcessing:(t,s=0)=>{e.content.isProcessing=t,e.content.processingProgress=s},addBatchJob:t=>{e.batch.jobs[t.id]=t,e.batch.queue.push(t.id),a.info(`Added batch job: ${t.id} with ${t.urls.length} URLs`)},updateBatchJob:(t,s)=>{const o=e.batch.jobs[t];o&&(e.batch.jobs[t]={...o,...s},a.info(`Updated batch job: ${t}`))},setActiveBatchJob:t=>{e.batch.activeJob=t},setBatchProcessing:t=>{e.batch.isProcessing=t},setTransformationOpportunities:t=>{e.transformation.opportunities=t},addTransformationOpportunity:t=>{e.transformation.opportunities.push(t)},setTransformationAnalyzing:t=>{e.transformation.isAnalyzing=t},setCurrentTransformation:t=>{e.transformation.currentTransformation=t},addTransformationToHistory:t=>{e.transformation.transformationHistory.push({...t,timestamp:Date.now().toString()})},setActiveView:t=>{e.ui.activeView=t},setSearchQuery:t=>{e.ui.searchQuery=t},setFilters:t=>{Object.assign(e.ui.filters,t)},toggleItemSelection:t=>{const s=e.ui.selectedItems.indexOf(t);s>-1?e.ui.selectedItems.splice(s,1):e.ui.selectedItems.push(t)},clearSelection:()=>{e.ui.selectedItems.length=0},addNotification:t=>{const s=crypto.randomUUID();e.ui.notifications.push({...t,id:s,timestamp:Date.now().toString()}),t.type!=="error"&&setTimeout(()=>{h.removeNotification(s)},5e3)},removeNotification:t=>{const s=e.ui.notifications.findIndex(o=>o.id===t);s>-1&&e.ui.notifications.splice(s,1)}};export{w as getBatchProgress,C as getContentStats,S as getFilteredSources,h as webContentActions,e as webContentState};
