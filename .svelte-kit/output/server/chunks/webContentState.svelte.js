import"clsx";import{c as u}from"./utils.js";const r=u("web-content-state"),e={sources:{items:{},currentSource:null,isLoading:!1,lastUpdated:null},content:{items:{},currentContent:null,isProcessing:!1,processingProgress:0},batch:{jobs:{},activeJob:null,queue:[],isProcessing:!1},transformation:{opportunities:[],isAnalyzing:!1,currentTransformation:null,transformationHistory:[]},ui:{activeView:"sources",selectedItems:[],searchQuery:"",filters:{domain:"",category:"",status:"all"},notifications:[]}},l=()=>{const{items:t}=e.sources,{searchQuery:s,filters:o}=e.ui;let n=Object.values(t);const a=(s||"").toLowerCase();return a.trim()&&(n=n.filter(i=>i.title.toLowerCase().includes(a)||i.domain.toLowerCase().includes(a)||i.metadata.tags.some(c=>c.toLowerCase().includes(a)))),o.domain&&(n=n.filter(i=>i.domain===o.domain)),o.category&&(n=n.filter(i=>i.metadata.category===o.category)),o.status!=="all"&&(n=n.filter(i=>i.status===o.status)),n};function p(){return l()}const d=()=>{const t=Object.keys(e.sources.items).length,s=Object.keys(e.content.items).length,o=Object.values(e.batch.jobs).filter(n=>n.status==="processing").length;return{totalSources:t,totalContent:s,activeJobs:o,transformationOpportunities:e.transformation.opportunities.length}};function h(){return d()}const f={addSource:t=>{e.sources.items[t.id]=t,e.sources.lastUpdated=Date.now().toString(),r.info(`Added source: ${t.title}`)},updateSource:(t,s)=>{const o=e.sources.items[t];if(o){const n={...o,...s,lastChecked:new Date};e.sources.items[t]=n,e.sources.lastUpdated=Date.now().toString(),r.info(`Updated source: ${t}`)}},removeSource:t=>{e.sources.items[t]&&(delete e.sources.items[t],e.sources.lastUpdated=Date.now().toString(),r.info(`Removed source: ${t}`))},setCurrentSource:t=>{e.sources.currentSource=t},setSourcesLoading:t=>{e.sources.isLoading=t},addContent:t=>{e.content.items[t.id]=t,r.info(`Added content: ${t.title}`)},updateContent:(t,s)=>{const o=e.content.items[t];o&&(e.content.items[t]={...o,...s},r.info(`Updated content: ${t}`))},setCurrentContent:t=>{e.content.currentContent=t},setContentProcessing:(t,s=0)=>{e.content.isProcessing=t,e.content.processingProgress=s},addBatchJob:t=>{e.batch.jobs[t.id]=t,e.batch.queue.push(t.id),r.info(`Added batch job: ${t.id} with ${t.urls.length} URLs`)},updateBatchJob:(t,s)=>{const o=e.batch.jobs[t];o&&(e.batch.jobs[t]={...o,...s},r.info(`Updated batch job: ${t}`))},setActiveBatchJob:t=>{e.batch.activeJob=t},setBatchProcessing:t=>{e.batch.isProcessing=t},setTransformationOpportunities:t=>{e.transformation.opportunities=t},addTransformationOpportunity:t=>{e.transformation.opportunities.push(t)},setTransformationAnalyzing:t=>{e.transformation.isAnalyzing=t},setCurrentTransformation:t=>{e.transformation.currentTransformation=t},addTransformationToHistory:t=>{e.transformation.transformationHistory.push({...t,timestamp:Date.now().toString()})},setActiveView:t=>{e.ui.activeView=t},setSearchQuery:t=>{e.ui.searchQuery=t},setFilters:t=>{Object.assign(e.ui.filters,t)},toggleItemSelection:t=>{const s=e.ui.selectedItems.indexOf(t);s>-1?e.ui.selectedItems.splice(s,1):e.ui.selectedItems.push(t)},clearSelection:()=>{e.ui.selectedItems.length=0},addNotification:t=>{const s=crypto.randomUUID();e.ui.notifications.push({...t,id:s,timestamp:Date.now().toString()}),t.type!=="error"&&setTimeout(()=>{f.removeNotification(s)},5e3)},removeNotification:t=>{const s=e.ui.notifications.findIndex(o=>o.id===t);s>-1&&e.ui.notifications.splice(s,1)}};export{h as getContentStats,p as getFilteredSources,f as webContentActions,e as webContentState};
